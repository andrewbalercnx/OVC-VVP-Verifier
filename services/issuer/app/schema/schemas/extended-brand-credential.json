{
  "$id": "EK7kPhs5YkPsq9mZgUfPYfU-zq5iSlU8XVYJWqrVPk6g",
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "Extended Brand Credential",
  "description": "Brand credential with required certification edge linking to issuing vetter's Vetter Certification credential. Per the VVP Multichannel Vetters spec, each brand credential must contain a backlink to the vetter's certification for jurisdictional constraint validation of brand assertion.",
  "type": "object",
  "credentialType": "ExtendedBrandCredential",
  "version": "1.0.0",
  "required": [
    "v",
    "d",
    "u",
    "i",
    "ri",
    "s",
    "a",
    "e",
    "r"
  ],
  "properties": {
    "v": {
      "description": "Version",
      "type": "string"
    },
    "d": {
      "description": "Credential SAID",
      "type": "string"
    },
    "u": {
      "description": "A salty nonce",
      "type": "string"
    },
    "i": {
      "description": "Issuer AID (vetter)",
      "type": "string"
    },
    "ri": {
      "description": "Credential status registry",
      "type": "string"
    },
    "s": {
      "description": "Schema SAID",
      "type": "string"
    },
    "a": {
      "oneOf": [
        {
          "description": "Attributes block SAID",
          "type": "string"
        },
        {
          "$id": "",
          "description": "Attributes block",
          "type": "object",
          "required": [
            "d",
            "u",
            "i",
            "dt",
            "brandName",
            "assertionCountry"
          ],
          "properties": {
            "d": {
              "description": "Attributes block SAID",
              "type": "string"
            },
            "u": {
              "description": "A salty nonce",
              "type": "string"
            },
            "i": {
              "description": "Brand owner AID (issuee)",
              "type": "string"
            },
            "dt": {
              "description": "Issuance date time",
              "format": "date-time",
              "type": "string"
            },
            "brandName": {
              "description": "Name of the brand being asserted",
              "type": "string",
              "minLength": 1
            },
            "brandDisplayName": {
              "description": "Optional display name for the brand (for caller ID)",
              "type": "string"
            },
            "assertionCountry": {
              "description": "ISO 3166-1 alpha-3 country code where the brand is being asserted (e.g., GBR, FRA, USA). Required for jurisdictional constraint validation per VVP Multichannel Vetters spec.",
              "type": "string",
              "pattern": "^[A-Z]{3}$"
            },
            "logoUrl": {
              "description": "URL to brand logo image",
              "type": "string",
              "format": "uri"
            },
            "websiteUrl": {
              "description": "URL to brand website",
              "type": "string",
              "format": "uri"
            },
            "legalEntityLEI": {
              "description": "LEI of the legal entity that owns the brand",
              "type": "string",
              "format": "ISO 17442"
            },
            "startDate": {
              "description": "Start date of brand assertion validity",
              "format": "date-time",
              "type": "string"
            },
            "endDate": {
              "description": "Expiration date of brand assertion",
              "format": "date-time",
              "type": "string"
            }
          },
          "additionalProperties": false
        }
      ]
    },
    "e": {
      "oneOf": [
        {
          "description": "Edges block SAID",
          "type": "string"
        },
        {
          "$id": "",
          "description": "Edges block",
          "type": "object",
          "properties": {
            "d": {
              "description": "Edges block SAID",
              "type": "string"
            },
            "le": {
              "description": "Edge to Legal Entity credential that owns this brand",
              "type": "object",
              "properties": {
                "n": {
                  "description": "SAID of Legal Entity credential",
                  "type": "string"
                },
                "s": {
                  "description": "SAID of Legal Entity schema",
                  "type": "string"
                },
                "o": {
                  "description": "Operator indicating relationship",
                  "type": "string",
                  "const": "I2I"
                }
              },
              "additionalProperties": false,
              "required": [
                "n",
                "s"
              ]
            },
            "certification": {
              "description": "REQUIRED: Backlink to the issuing vetter's Vetter Certification credential. Per the VVP Multichannel Vetters spec, this edge enables verification that the vetter is authorized to issue brand credentials for the brand's assertion country.",
              "type": "object",
              "required": [
                "n",
                "s"
              ],
              "properties": {
                "n": {
                  "description": "SAID of the vetter's Vetter Certification credential",
                  "type": "string"
                },
                "s": {
                  "description": "SAID of the Vetter Certification schema",
                  "type": "string"
                }
              },
              "additionalProperties": false
            }
          },
          "additionalProperties": false,
          "required": [
            "d",
            "certification"
          ]
        }
      ]
    },
    "r": {
      "oneOf": [
        {
          "description": "Rules section SAID",
          "type": "string"
        },
        {
          "$id": "",
          "description": "Rules detail",
          "type": "object",
          "required": [
            "d",
            "brandUsageTerms"
          ],
          "properties": {
            "d": {
              "description": "Rule section SAID",
              "type": "string"
            },
            "brandUsageTerms": {
              "description": "Brand usage terms and conditions",
              "oneOf": [
                {
                  "description": "Compact rule form",
                  "type": "string",
                  "const": "The brand credential holder agrees to use this brand identity only for legitimate communications and in accordance with the brand owner's guidelines and applicable regulations."
                },
                {
                  "description": "Rule detail",
                  "type": "object",
                  "properties": {
                    "l": {
                      "description": "Associated legal language",
                      "type": "string",
                      "const": "The brand credential holder agrees to use this brand identity only for legitimate communications and in accordance with the brand owner's guidelines and applicable regulations."
                    }
                  },
                  "required": [
                    "l"
                  ],
                  "additionalProperties": false
                }
              ]
            }
          },
          "additionalProperties": false
        }
      ]
    }
  },
  "additionalProperties": false
}
