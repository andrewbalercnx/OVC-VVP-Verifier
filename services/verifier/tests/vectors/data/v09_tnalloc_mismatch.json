{
  "id": "v09",
  "name": "tnalloc_mismatch",
  "description": "PASSporT orig.tn not covered by TNAlloc credential range -> INVALID with TN_RIGHTS_INVALID",
  "tier": 3,
  "input": {
    "vvp_identity_header": "eyJwcHQiOiAidnZwIiwgImtpZCI6ICJodHRwOi8vd2l0bmVzcy5leGFtcGxlLmNvbS9vb2JpL0JJSG9HZUpLQ0hpWFhjUEg3b01SOEVmOUxnVDVVRmk3T25yZzU0SFlqR3JZL3dpdG5lc3MvRVh5eldpdG5lc3MwMDAwIiwgImV2ZCI6ICJodHRwOi8vZXhhbXBsZS5jb20vZG9zc2llciIsICJpYXQiOiAxNzA0MDY3MjAwfQ",
    "passport_jwt": "eyJhbGciOiAiRWREU0EiLCAicHB0IjogInZ2cCIsICJraWQiOiAiaHR0cDovL3dpdG5lc3MuZXhhbXBsZS5jb20vb29iaS9CSUhvR2VKS0NIaVhYY1BIN29NUjhFZjlMZ1Q1VUZpN09ucmc1NEhZakdyWS93aXRuZXNzL0VYeXpXaXRuZXNzMDAwMCJ9.eyJpYXQiOjE3MDQwNjcyMDAsIm9yaWciOnsidG4iOlsiKzEyMDI1NTUxMjM0Il19LCJkZXN0Ijp7InRuIjpbIisxMjAyNTU1NTY3OCJdfSwiZXZkIjoiaHR0cDovL2V4YW1wbGUuY29tL2Rvc3NpZXIifQ.AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA",
    "call_context": {
      "call_id": "test-v09",
      "received_at": "2024-01-01T00:00:00Z"
    }
  },
  "artifacts": {
    "evd_body": "[{\"d\":\"SAID_ROOT\",\"i\":\"BIHoGeJKCHiXXcPH7oMR8Ef9LgT5UFi7Onrg54HYjGrY\",\"s\":\"TNALLOC_SCHEMA\",\"a\":{\"tn_range_start\":\"+19995550000\",\"tn_range_end\":\"+19995559999\"}}]",
    "evd_content_type": "application/json",
    "http_status_evd": 200,
    "should_timeout_evd": false,
    "mock_tn_mismatch": true
  },
  "verification_context": {
    "reference_time_t": 1704067200,
    "clock_skew": 300,
    "max_token_age": 300
  },
  "expected": {
    "overall_status": "INVALID",
    "root_claim": {
      "name": "caller_authorised",
      "status": "INVALID",
      "children": [
        {
          "required": true,
          "node": {
            "name": "passport_verified",
            "status": "VALID"
          }
        },
        {
          "required": true,
          "node": {
            "name": "dossier_verified",
            "status": "VALID"
          }
        },
        {
          "required": true,
          "node": {
            "name": "authorization_valid",
            "status": "INVALID",
            "children": [
              {
                "required": true,
                "node": {
                  "name": "party_authorized",
                  "status": "VALID"
                }
              },
              {
                "required": true,
                "node": {
                  "name": "tn_rights_valid",
                  "status": "INVALID",
                  "reasons_contain": [
                    "not covered"
                  ]
                }
              }
            ]
          }
        },
        {
          "required": false,
          "node": {
            "name": "context_aligned",
            "status": "INDETERMINATE",
            "reasons_contain": [
              "SIP context not provided"
            ]
          }
        }
      ]
    },
    "errors": [
      {
        "code": "TN_RIGHTS_INVALID",
        "recoverable": false
      }
    ]
  }
}